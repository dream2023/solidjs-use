import{O as T,q as b,G as h,u as F,Z as V}from"./index-4e362e33.js";import{w as C}from"./index-c5ce925c.js";import{n as W}from"./scheduler-3ae68f06.js";import{u as N}from"./index-01b64411.js";const g=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},p="__solidjs-use_ssr_handlers__";g[p]=g[p]??{};const x=g[p];function M(e,s){return x[e]??s}function q(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const G={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},A="vueuse-storage";function R(e,s,n,S={}){const{listenToStorageChanges:O=!0,writeDefaults:_=!0,mergeDefaults:c=!1,window:u=b,eventFilter:D,onError:d=t=>{console.error(t)}}=S,[o,l]=T(s);if(!n)try{n=M("getDefaultStorage",()=>b?.localStorage)()}catch(t){d(t)}if(!n)return h(s)?o:[o,l];const a=F(s),w=q(a),f=S.serializer??G[w],{pause:E,resume:y}=C(o,()=>J(o()),{eventFilter:D,defer:!1});return u&&O&&(N(u,"storage",m),N(u,A,z)),m(),h(s)?o:[o,l];function J(t){try{if(t==null)n.removeItem(e);else{const r=f.write(t),i=n.getItem(e);i!==r&&(n.setItem(e,r),u&&u.dispatchEvent(new CustomEvent(A,{detail:{key:e,oldValue:i,newValue:r,storageArea:n}})))}}catch(r){d(r)}}function j(t){const r=t?t.newValue:n.getItem(e);if(r==null)return _&&a!==null&&n.setItem(e,f.write(a)),a;if(!t&&c){const i=f.read(r);return V(c)?c(i,a):w==="object"&&!Array.isArray(i)?{...a,...i}:i}else if(typeof r!="string")return r;return f.read(r)}function z(t){m(t.detail)}function m(t){if(!(t&&t.storageArea!==n)){if(t&&t.key==null){l(()=>a);return}if(!(t&&t.key!==e)){E();try{l(j(t))}catch(r){d(r)}finally{t?W(y):y()}}}}}export{M as g,R as u};
