import{N as T,p as b,E as h,q as V}from"./index-66786029.js";import{w as C}from"./index-7fe291eb.js";import{n as F}from"./scheduler-3ae68f06.js";import{u as N}from"./index-fcbdd517.js";const c=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},d="__solidjs-use_ssr_handlers__",W=x();function x(){return d in c||(c[d]=c[d]??{}),c[d]}function H(e,o){return W[e]??o}function M(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const q={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},A="vueuse-storage";function B(e,o,n,S={}){const{listenToStorageChanges:E=!0,writeDefaults:O=!0,mergeDefaults:m=!1,window:l=b,eventFilter:_,onError:g=t=>{console.error(t)}}=S,[s,u]=T(o);if(!n)try{n=H("getDefaultStorage",()=>b?.localStorage)()}catch(t){g(t)}if(!n)return h(o)?s:[s,u];const a=V(o),w=M(a),f=S.serializer??q[w],{pause:D,resume:y}=C(s,()=>J(s()),{eventFilter:_,defer:!1});return l&&E&&(N(l,"storage",p),N(l,A,z)),p(),h(o)?s:[s,u];function J(t){try{if(t==null)n.removeItem(e);else{const r=f.write(t),i=n.getItem(e);i!==r&&(n.setItem(e,r),l&&l.dispatchEvent(new CustomEvent(A,{detail:{key:e,oldValue:i,newValue:r,storageArea:n}})))}}catch(r){g(r)}}function j(t){const r=t?t.newValue:n.getItem(e);if(r==null)return O&&a!==null&&n.setItem(e,f.write(a)),a;if(!t&&m){const i=f.read(r);return typeof m=="function"?m(i,a):w==="object"&&!Array.isArray(i)?{...a,...i}:i}else if(typeof r!="string")return r;return f.read(r)}function z(t){p(t.detail)}function p(t){if(!(t&&t.storageArea!==n)){if(t&&t.key==null){u(()=>a);return}if(!(t&&t.key!==e)){D();try{u(j(t))}catch(r){g(r)}finally{t?F(y):y()}}}}}export{H as g,B as u};
